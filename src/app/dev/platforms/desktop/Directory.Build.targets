<Project>
  <Import Project="$([MSBuild]::GetPathOfFileAbove('Directory.Build.targets', '$(MSBuildThisFileDirectory)../'))" />

  <Target Name="ImportPluginAfterBuild" AfterTargets="Build">
    <Message Text="Importing plugins..." Importance="high" />
    <ItemGroup>
      <PluginOutput Include="$(RepoRoot)bin\$(Configuration)\Plugins\**\*" />
    </ItemGroup>
    <Copy
      SourceFiles="@(PluginOutput)"
      DestinationFolder="$(OutputPath)\Plugins\%(RecursiveDir)"
      SkipUnchangedFiles="true"
      OverwriteReadOnlyFiles="true"
      Retries="10"
      RetryDelayMilliseconds="1000" />
    <Message Text="Plugins importanted!" Importance="high" />
  </Target>
  <Target Name="ImportPluginInAppxAfterBuild" BeforeTargets="_CalculateAppxBundleProperties">
    <Message Text="Importing plugins..." Importance="high" />
    <ItemGroup>
      <PluginOutput Include="$(RepoRoot)bin\$(Configuration)\Plugins\**\*" />
    </ItemGroup>
    <Copy
      SourceFiles="@(PluginOutput)"
      DestinationFolder="$(OutputPath)\Appx\Plugins\%(RecursiveDir)"
      SkipUnchangedFiles="true"
      OverwriteReadOnlyFiles="true"
      Retries="10"
      RetryDelayMilliseconds="1000" />
    <Message Text="Plugins importanted!" Importance="high" />
  </Target>
</Project>